<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
    PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
    "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<!-- namespace命名空间，做sql隔离 -->
<mapper namespace="cn.yichen.bootwebmybatis.security.dao.ISysFunctionDao">
    <!-- 
        id:sql语句唯一标识
        parameterType:指定传入参数类型(对应javaBean类型，写原始型会自动包装为包装类)
        resultType：返回结果类型
        #{}:占位符号，起到占位作用，如果传入的是原始型，那么括号中的变量名称可以随意定义
     -->
     <!-- 启动对给定命名空间的缓存并进行配置 -->
     <cache></cache>
     
    <resultMap id="sysFunctionModelMap" type="SysFunction">
    	<id column="FUNNO" property="no"/>
    	<result column="FUNNAME" property="name"/>
    	<result column="FUNURL" property="url"/>
    </resultMap>
    
    <resultMap type="SysFunction" id="sysFunctionModelMapWithModel" extends="sysFunctionModelMap"> 
    	<association property="sysModel" javaType="SysModel"
    		select="cn.yichen.bootwebmybatis.security.dao.ISysModelDao.selectListById" column="MNO" fetchType="lazy">
    	</association>
    </resultMap>

    <sql id="sysFunctionWhen">
	    	<if test="no != null"> and FUNNO like '%${no}%' </if>
	    	<if test="name != null"> and FUNNAME like '%${name}%' </if>
	    	<if test="mno != null"> and MNO = #{sysModel.no} </if>
	    	<if test="url != null"> and FUNURL like '%${url}%' </if>
    </sql>

	<insert id="create" flushCache="true" useGeneratedKeys="true">
		insert into systemfunction(FUNNO, MNO, FUNNAME, FUNURL) values(#{no}, #{sysModel.no}, #{name}, #{url})
	</insert>
	
	<delete id="delete" flushCache="true">
		delete from systemfunction where FUNNO = #{no}
	</delete>
     
    <update id="update" flushCache="true">
    	update systemfunction set MNO = #{sysModel.no}, FUNNAME = #{name}, FUNURL = #{url} where FUNNO = #{no}
    </update>
     
    <select id="selectListByAll" resultMap="sysFunctionModelMap" useCache="true">
        select FUNNO, MNO, FUNNAME, FUNURL 
        from systemfunction
        <where>
        	<include refid="sysFunctionWhen"></include>
        </where>
    </select>
    
    <select id="selectListById" resultMap="sysFunctionModelMapWithModel" useCache="true">
    	select FUNNO, MNO, FUNNAME, FUNURL from systemfunction where FUNNO = #{no}
    </select>
    
</mapper>