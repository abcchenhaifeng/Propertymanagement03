<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="cn.yichen.propertymgt.baseinfo.mapper.ICustomerMapper">

	<cache />

	<resultMap id="CustomerMap" type="Customer">
		<id column="CustomerNo" property="customerNo" />
		<!--result column="TYPENO" property="typeNo" /-->
		<result column="CNAME" property="cname" />
		<result column="Contact" property="contact" />
		<result column="CardCode" property="cardcode" />
		<result column="Mobile" property="mobile" />
		<result column="FeeStartDate" property="feeStartDate" />
		<result column="FeeEndDate" property="feeEndDate" />
		<result column="CStatus" property="cstatus" />
	</resultMap>

	<select id="selectCustomerById" resultMap="CustomerMap">
		select * from Customer
		where CustomerNo = #{customerNo} 
	</select>

	<select id="selectListByAll" resultMap="CustomerMap">
		select * from Customer
	</select>
	
     <select id="selectListByAllWithPage" resultMap="CustomerMap">
		select * from Customer limit #{start},#{rows}
	</select>
	
	<resultMap id="CustomerMapByIdWithType" type="Customer" extends="CustomerMap">
		<association property="customertype"
			resultMap="cn.yichen.propertymgt.baseinfo.mapper.ICustomerTypeMapper.CustomerTypeMap">
		</association>
	</resultMap>
	
	<select id="selectCustomerByIdWithType" resultMap="CustomerMapByIdWithType">
	select CustomerNo, c.TypeNo, Cname, Contact, CardCode, Mobile, FeeStartDate,FeeEndDate,Cstatus,ct.TYPENAME
	from Customer c, CustomerType ct
	where CustomerNo = #{customerNo}  and c.typeNo = ct.typeNo
	</select>
	
	<select id="selectCustomerByAllWithType" resultMap="CustomerMapByIdWithType">
	select CustomerNo, c.TypeNo, Cname, Contact, CardCode, Mobile, FeeStartDate,FeeEndDate,Cstatus,ct.TYPENAME
	from Customer c, CustomerType ct
	where c.typeNo = ct.typeNo
	</select>
	
	<select id="selectCustomerByAllAndTypeWithPage" resultMap="CustomerMapByIdWithType">
	select CustomerNo, c.TypeNo, Cname, Contact, CardCode, Mobile,FeeStartDate,FeeEndDate,Cstatus,ct.TYPENAME
	from Customer c, CustomerType ct
	where c.typeNo = ct.typeNo limit #{start},#{rows}
	</select>
	<!-- 
	<resultMap id="CustomerMapByIdWithHome" type="Customer" extends="CustomerMap">
		<association property="customerhome"
			resultMap="cn.yichen.propertymgt.baseinfo.mapper.ICustomerHomeMapper.CustomerHomeMap">
		</association>
	</resultMap>
	
	<select id="selectCustomerByIdWithHome" resultMap="CustomerMapByIdWithHome">
	select c.*,CHNO, RoomNo, LivingTypeNo, ReceiveDate, LiveDate,HumanCount,CHStatus 
	from Customer c, CustomerHome ch
	where c.CustomerNo = #{customerNo}  and c.customerNo = ch.customerNo
	</select>
	
	<select id="selectCustomerByAllandHomeWithPage" resultMap="CustomerMapByIdWithHome">
	select c.*,CHNO, RoomNo, LivingTypeNo, ReceiveDate, LiveDate,HumanCount,CHStatus 
	from Customer c, CustomerHome ch
	where c.customerNo = ch.customerNo limit #{start},#{rows}
	</select>
	 -->
	<!-- 取得个数，使用IFNULL函数判断count函数结果是否为null, 为null返回0 -->
	<select id="selectCountByAll" resultType="int">
		select IFNULL(count(CustomerNo), 0) from Customer
	</select>
	
	<!-- 根据综合检索条件取得员工个数-->
  <select id="selectCountByCondition" resultType="int">
  select IFNULL(count(CustomerNo), 0) from Customer 
  <where>
     <if test="customerNo!=0">
      and CustomerNo=#{customerNo}
     </if>
     <if test="cname!=null and cname!=''">
     and CNAME=#{cname}
     </if>
     <if test="contact!=null and contact!=''">
     and Contact=#{contact}
     </if>
     <if test="cardCode!=null and cardCode!=''">
     and CardCode=#{cardCode}
     </if>
     <if test="mobile!=null and mobile!=''">
     and Mobile=#{mobile}
     </if>
  </where>
   
  </select>
	
</mapper>